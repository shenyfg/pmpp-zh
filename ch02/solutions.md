# 第2章

### 解答 1

C

> 索引i = 块id * 纬度id + 线程id

### 解答 2

C

> 假定每个block的纬度是256，则第一个块中每个线程处理的元素id是0 -> (0,1), 1 -> (2,3) ... 255 -> (510,511)，
> 第二个块中的id是256 -> (512,513), 257 -> (514,515) ... 511 -> (1022,1023)，
> 由此可以得到 i = (blockIdx.x \* blockDim.x + threadIdx.x) \* 2。

### 解答 3

D

> 假定每个block的纬度是256，则第一个块中处理的元素是0 - 255，接着再处理 256 - 511。
> 第二个块中处理的是 512 - 767，接着处理 768 - 1023
>
> 所以答案是D，i = (blockIdx.x \* blockDim.x) \* 2 + threadIdx.x。

### 解答 4

C

> 一个块1024个线程，总共8000个元素，那么至少需要4个块，共 1024 * 4 = 8192 个线程

### 解答 5

D

### 解答 6

D

> 参考接口定义，需要传入A_d指针的地址，并转为void**类型

### 解答 7

C

### 解答 8

C

### 解答 9

考虑以下 CUDA 内核及其对应的调用它的主机函数:

```c
01 __global__ void foo_kernel(float* a, float* b, unsigned int N) {
02     unsigned int i = blockIdx.x * blockDim.x + threadIdx.x;
03
04     if (i < N) {
05         b[i] = 2.7f * a[i] - 4.3f;
06     }
07 }
08
09 void foo(float* a_d, float* b_d) {
10     unsigned int N = 200000;
11     foo_kernel<<<(N + 128 - 1) / 128, 128>>>(a_d, b_d, N);
12 }
```

**a. 每个块中有多少个线程?**

每个块中有128个线程


> <<<>>>的第一个参数是块数，第二个每个块中的线程数

**b. 网格中有多少个线程?**

一共有1563个块，线程数 1563 * 128 = 200064

**c. 网格中有多少个块?**

1563

**d. 有多少个线程执行第 02 行的代码?**

200064

**e. 有多少个线程执行第 04 行的代码?**

200000

### 解答 10

可以用`__host__`和`__device__`同时申明一个函数，这样编译系统会同时生成主机版本和设备版本，不用复制代码
